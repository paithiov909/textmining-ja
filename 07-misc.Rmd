# Miscellaneous {#misc}

## Posit Cloud（旧・RStudio Cloud）でのgibasaの使い方

手軽に試したい場合には、Posit Cloud（旧・RStudio Cloud）のようなクラウド環境が便利かもしれません。

一方で、Posit Cloudはユーザー権限しかない環境のため、gibasaを使えるようにするまでにはややコツが要ります。とはいえ、gibasaはRMeCabとは異なり、MeCabのバイナリはなくても使える（辞書とmecabrcがあればよい）ので、RMeCabを使う場合ほど複雑なことをする必要はないはずです。

ここでは、Posit Cloudでgibasaを利用できるようにするための手順を簡単に説明します（RMeCabもあわせて試したいという場合には、MeCabのバイナリを自分でビルドする必要があります。その場合は[この記事](https://blog.mana.bi/2022/12/21/posit-cloud-mecab/)などを参考にしてください）。

### 辞書（ipadic, unidic-lite）の配置

MeCabの辞書は、Terminalタブからpipでインストールできます。ここでは、IPA辞書（[ipadic](https://pypi.org/project/ipadic/)）と[unidic-lite](https://pypi.org/project/unidic-lite/)をインストールします。

```bash
pip install ipadic unidic-lite
```

### mecabrcの配置

Rのコンソールから以下のおまじないを実行します。

```r
if (!dir.exists(path.expand("~/.local/etc"))) {
    dir.create(path.expand("~/.local/etc"))
}
write(";
; Configuration file of MeCab
;
; $Id: mecabrc.in,v 1.3 2006/05/29 15:36:08 taku-ku Exp $;
;
dicdir = /$(rcpath)/../lib/python3.8/site-packages/ipadic/dicdir
; userdic = /home/foo/bar/user.dic
; output-format-type = wakati
; input-buffer-size = 8192
; node-format = %m\n
; bos-format = %S\n
; eos-format = EOS\n
", path.expand("~/.local/etc/mecabrc"))
```

### gibasaのインストール

[gibasa](https://github.com/paithiov909/gibasa)をインストールします。

```r
options(repos = c(
  paithiov909 = "https://paithiov909.r-universe.dev",
  CRAN = "https://cloud.r-project.org"))
Sys.setenv(MECAB_DEFAULT_RC = path.expand("~/.local/etc/mecabrc"))
install.packages("gibasa")
```

### 試すには

うまくいっていると、辞書を指定しない場合はIPA辞書が使われます。unidic-liteは`sys_dic`引数にフルパスを指定することで使用できます。

```r
gibasa::gbs_tokenize("こんにちは")
unidic_lite <- path.expand("~/.local/lib/python3.8/site-packages/unidic_lite/dicdir")
gibasa::gbs_tokenize("こんにちは", sys_dic = unidic_lite) |>
  gibasa::prettify(into = gibasa::get_dict_features("unidic26"))
```
